#!/usr/bin/env bash
if [ $# -lt 1 ]
then
    echo -e "No arguments were given\nUsuage: `basename $0` \"command to be executed on all ring servers\""
    exit 65
fi

SERVERS=$(dig -t txt +short ring.nlnog.net | sed 's/\"//g')
for host in $SERVERS
do
echo "host: $host.ring.nlnog.net"
ssh -q -t $host.ring.nlnog.net $@ || echo "ERROR: ssh command failed"
echo ""
done
